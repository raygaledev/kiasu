import { Globe } from 'lucide-react';

const iconClass = 'h-4 w-4 shrink-0';

const platforms: {
  hostnames: string[];
  pathPrefix?: string;
  icon: React.ReactNode;
}[] = [
  {
    hostnames: ['youtube.com', 'youtu.be'],
    icon: (
      <svg viewBox="0 0 24 24" fill="#FF0000" className={iconClass}>
        <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z" />
      </svg>
    ),
  },
  {
    hostnames: ['udemy.com'],
    icon: (
      <svg viewBox="0 0 24 24" fill="#A435F0" className={iconClass}>
        <path d="M12 0L5.81 3.573v3.574l6.189-3.574 6.191 3.574V3.573zM5.81 10.148v8.144c0 1.85.589 3.243 1.741 4.234S10.177 24 11.973 24s3.269-.482 4.448-1.474c1.152-.991 1.741-2.384 1.741-4.234v-8.144l-3.573 2.053v5.825c0 .748-.187 1.343-.589 1.768-.375.428-.936.642-1.634.669h-.375c-.697-.027-1.258-.241-1.634-.669-.401-.425-.588-1.02-.588-1.768v-5.825z" />
      </svg>
    ),
  },
  {
    hostnames: ['twitter.com', 'x.com'],
    icon: (
      <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}>
        <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" />
      </svg>
    ),
  },
  {
    hostnames: ['github.com'],
    icon: (
      <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}>
        <path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12" />
      </svg>
    ),
  },
  {
    hostnames: ['linkedin.com'],
    icon: (
      <svg viewBox="0 0 24 24" fill="#0A66C2" className={iconClass}>
        <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" />
      </svg>
    ),
  },
  {
    hostnames: ['medium.com'],
    icon: (
      <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}>
        <path d="M13.54 12a6.8 6.8 0 01-6.77 6.82A6.8 6.8 0 010 12a6.8 6.8 0 016.77-6.82A6.8 6.8 0 0113.54 12zM20.96 12c0 3.54-1.51 6.42-3.38 6.42-1.87 0-3.39-2.88-3.39-6.42s1.52-6.42 3.39-6.42 3.38 2.88 3.38 6.42M24 12c0 3.17-.53 5.75-1.19 5.75-.66 0-1.19-2.58-1.19-5.75s.53-5.75 1.19-5.75C23.47 6.25 24 8.83 24 12z" />
      </svg>
    ),
  },
  {
    hostnames: ['coursera.org'],
    icon: (
      <svg viewBox="0 0 24 24" fill="#0056D2" className={iconClass}>
        <path d="M11.374 23.977c-4.243-.38-7.968-2.87-9.998-6.681a12.09 12.09 0 01-.378-.724C-.477 13.592.5 10.103 3.124 7.459a11.89 11.89 0 017.693-3.481l.063-.001V7.98a7.86 7.86 0 00-5.494 2.31c-1.57 1.57-2.564 3.91-2.063 6.543.9 4.724 5.946 7.199 10.09 5.07a7.89 7.89 0 003.463-3.47l3.558 1.835c-1.67 3.236-4.768 5.414-8.387 5.71l-.247.018-.425.001zm7.31-5.528l-3.535-1.86a7.89 7.89 0 001.088-5.584c-.898-4.723-5.944-7.198-10.088-5.07a7.888 7.888 0 00-1.727 1.2L1.7 4.512A12 12 0 0110.6.012c5.98.238 10.864 4.6 11.807 10.396.585 3.595-.33 7.003-2.383 9.608l-1.34-1.567z" />
      </svg>
    ),
  },
  {
    hostnames: ['reddit.com'],
    icon: (
      <svg viewBox="0 0 24 24" fill="#FF4500" className={iconClass}>
        <path d="M12 0C5.373 0 0 5.373 0 12c0 3.314 1.343 6.314 3.515 8.485l-2.286 2.286A.78.78 0 001.78 24H12c6.627 0 12-5.373 12-12S18.627 0 12 0zm5.995 13.905c.03.2.045.404.045.61 0 3.122-3.63 5.655-8.108 5.655-4.477 0-8.107-2.533-8.107-5.655 0-.203.015-.405.044-.606a2.07 2.07 0 01-.848-1.674c0-1.148.93-2.078 2.077-2.078.55 0 1.05.216 1.42.567 1.4-.975 3.33-1.605 5.476-1.68l.93-4.385a.388.388 0 01.464-.302l3.098.655c.22-.458.686-.77 1.225-.77a1.384 1.384 0 010 2.768 1.384 1.384 0 01-1.372-1.21l-2.79-.588-.833 3.94c2.1.095 4 .727 5.37 1.692.37-.36.876-.58 1.434-.58a2.078 2.078 0 011.475 3.541zm-11.59.33a1.384 1.384 0 102.768 0 1.384 1.384 0 00-2.768 0zm7.844 3.088a.387.387 0 00.006-.548c-.03-.03-.063-.052-.096-.072a.387.387 0 00-.452.06c-.636.635-1.576.93-2.872.903h-.046c-1.298.027-2.238-.268-2.873-.903a.387.387 0 00-.548.006.387.387 0 00.006.548c.822.82 1.967 1.195 3.41 1.166h.057c1.442.029 2.587-.346 3.408-1.16zm-.48-1.72a1.384 1.384 0 100-2.769 1.384 1.384 0 000 2.768z" />
      </svg>
    ),
  },
  {
    hostnames: ['stackoverflow.com'],
    icon: (
      <svg viewBox="0 0 24 24" fill="#F58025" className={iconClass}>
        <path d="M15.725 0l-1.72 1.277 6.39 8.588 1.716-1.277L15.725 0zm-3.94 3.418l-1.369 1.644 8.225 6.85 1.369-1.644-8.225-6.85zm-3.15 4.465l-.905 1.94 9.702 4.517.904-1.94-9.701-4.517zm-1.85 4.86l-.44 2.093 10.473 2.201.44-2.092-10.473-2.203zM1.89 15.47V24h19.19v-8.53h-2.133v6.397H4.021v-6.396H1.89zm4.265 2.468v2.132h10.66v-2.132H6.154z" />
      </svg>
    ),
  },
  {
    hostnames: ['dev.to'],
    icon: (
      <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}>
        <path d="M7.42 10.05c-.18-.16-.46-.23-.84-.23H6v4.36h.58c.37 0 .65-.08.84-.23.2-.16.29-.45.29-.84v-2.22c0-.39-.1-.68-.29-.84zM0 2.92v18.16h24V2.92H0zm8.56 9.09c0 .93-.27 1.65-.82 2.15-.55.5-1.32.75-2.32.75H3.55V8.99h1.87c1 0 1.77.25 2.32.75.55.5.82 1.22.82 2.15v2.12zm4.35 2.9H9.67V8.99h3.24v1.29h-1.72v1.8h1.44v1.29h-1.44v2.3h1.72v1.29zm6.53-5.16c0 .6-.12 1.05-.35 1.35-.23.3-.58.45-1.06.45-.47 0-.82-.15-1.06-.45s-.35-.75-.35-1.35V8.99h-1.52v1.76c0 1.03.24 1.81.72 2.34.48.53 1.17.79 2.09.79s1.61-.26 2.09-.79c.48-.53.72-1.31.72-2.34V8.99h-1.52v1.76h.24z" />
      </svg>
    ),
  },
  {
    hostnames: ['news.ycombinator.com'],
    icon: (
      <svg viewBox="0 0 24 24" fill="#F0652F" className={iconClass}>
        <path d="M0 0v24h24V0H0zm12.8 14.4v5.067H11.2V14.4L6.4 4.8h1.867L12 12.267 15.733 4.8H17.6l-4.8 9.6z" />
      </svg>
    ),
  },
  {
    hostnames: ['wikipedia.org'],
    icon: (
      <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}>
        <path d="M12.09 13.119c-.936 1.932-2.217 4.548-2.853 5.728-.616 1.074-1.127.825-1.532.054a186.4 186.4 0 01-2.042-4.493c-1.34-3.09-2.69-6.217-3.888-9.38-.16-.423-.378-.847-.678-1.164-.3-.316-.704-.57-1.193-.623l-.104-.011C-.172 3.157-.053 2.875 0 2.73c.003-.008.006-.014.009-.019l.034-.063.088-.076c.2-.023.398-.034.595-.034.4 0 .882.018 1.473.06 1.076.066 1.833.108 2.467.107.735-.001 1.237-.035 2.147-.107.02-.002.04-.002.06-.002.17 0 .352.08.375.347.018.206-.113.365-.287.397l-.277.051c-.537.1-1.048.259-.99.661.026.181.1.375.195.585.798 1.783 1.62 3.558 2.448 5.328l.245.524c.73-1.46 1.414-2.927 2.03-4.422.26-.634.386-1.156.386-1.592 0-.483-.348-.818-1.066-.96l-.198-.033c-.179-.03-.377-.155-.36-.363.018-.21.2-.345.368-.345.016 0 .032.001.048.003.553.06 1.079.097 1.58.097.55 0 1.032-.025 1.45-.084a.362.362 0 01.054-.004c.178 0 .345.143.362.348.018.21-.157.349-.34.381l-.134.024c-.689.123-1.065.349-1.487 1.18-.488.961-1.043 2.078-1.674 3.32l-.766 1.523c.826 1.698 1.834 3.728 2.394 4.834.524-1.07 1.28-2.678 1.894-3.998l.11-.238c.623-1.349 1.2-2.679 1.712-4.04.216-.573.312-1.017.312-1.365 0-.48-.326-.796-1.003-.945l-.2-.04c-.18-.036-.37-.16-.354-.363.016-.197.187-.337.358-.337a.487.487 0 01.06.004c.613.072 1.118.109 1.543.109.403 0 .85-.03 1.368-.094.02-.003.04-.004.059-.004.175 0 .348.136.365.34.018.209-.156.349-.339.381-.496.09-.842.234-1.09.568-.252.337-.522.804-.802 1.378-.596 1.225-1.274 2.632-2.06 4.215l-.075.147 2.478 5.016c.625-1.278 1.572-3.298 2.26-4.843.596-1.34 1.133-2.711 1.537-4.12.102-.36.12-.654.048-.876-.072-.222-.283-.405-.67-.527l-.274-.078c-.188-.054-.354-.19-.338-.389.016-.199.19-.329.362-.329.017 0 .034.001.05.003.565.063 1.07.095 1.531.095.43 0 .837-.023 1.234-.071a.44.44 0 01.059-.004c.168 0 .336.13.353.33.018.208-.15.353-.331.388l-.12.023c-.581.11-.999.369-1.332.906a62.3 62.3 0 01-1.1 1.903c-.334.555-1.18 2.322-1.904 3.791l-1.487 3.02c-.566 1.154-1.09 2.063-1.476 2.554-.194.246-.377.367-.568.367-.187 0-.373-.138-.602-.462-.592-.839-1.163-1.712-1.704-2.596l-.3-.497c-.81-1.35-1.558-2.725-2.233-4.128z" />
      </svg>
    ),
  },
  {
    hostnames: ['twitch.tv'],
    icon: (
      <svg viewBox="0 0 24 24" fill="#9146FF" className={iconClass}>
        <path d="M11.571 4.714h1.715v5.143H11.57zm4.715 0H18v5.143h-1.714zM6 0L1.714 4.286v15.428h5.143V24l4.286-4.286h3.428L22.286 12V0zm14.571 11.143l-3.428 3.428h-3.429l-3 3v-3H6.857V1.714h13.714z" />
      </svg>
    ),
  },
  {
    hostnames: ['notion.so', 'notion.site'],
    icon: (
      <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}>
        <path d="M4.459 4.208c.746.606 1.026.56 2.428.466l13.215-.793c.28 0 .047-.28-.046-.326L18.28 2.09c-.467-.373-.98-.746-2.054-.653l-12.8.932c-.467.047-.56.28-.374.466zm.793 3.08v13.904c0 .747.373 1.027 1.214.98l14.523-.84c.841-.046.934-.56.934-1.166V6.354c0-.606-.233-.933-.747-.886l-15.177.887c-.56.047-.747.327-.747.933zm14.337.745c.093.42 0 .84-.42.888l-.7.14v10.264c-.608.327-1.168.514-1.635.514-.748 0-.935-.234-1.495-.933l-4.577-7.186v6.952l1.449.327s0 .84-1.168.84l-3.222.186c-.093-.186 0-.653.327-.726l.84-.233V9.854L7.822 9.76c-.094-.42.14-1.026.793-1.073l3.456-.233 4.764 7.279v-6.44l-1.215-.14c-.093-.513.28-.886.747-.933zM1.936 1.035l13.31-.98c1.634-.14 2.054-.047 3.082.7l4.249 2.986c.7.513.934.653.934 1.213v16.378c0 1.026-.373 1.634-1.68 1.726l-15.458.934c-.98.046-1.448-.094-1.962-.747l-3.129-4.06c-.56-.747-.793-1.306-.793-1.96V2.667c0-.839.374-1.54 1.447-1.632z" />
      </svg>
    ),
  },
  {
    hostnames: ['docs.google.com'],
    pathPrefix: '/spreadsheets',
    icon: (
      <svg viewBox="0 0 24 24" fill="#0F9D58" className={iconClass}>
        <path d="M11.318 12.545H7.91v-1.909h3.41v1.91zM14.728 0v6.727h6l-6-6.727zm1.363 10.636h-3.41v1.91h3.41v-1.91zm0 3.273h-3.41v1.909h3.41v-1.91zM1.636 3.273v20.454h20.728V6.727h-6V0H4.909c-.904 0-1.636.732-1.636 1.636zM17.727 18.91H6.273v-9.545h11.454v9.545zm-6.41-3.272H7.91v1.909h3.41v-1.91z" />
      </svg>
    ),
  },
  {
    hostnames: ['docs.google.com'],
    icon: (
      <svg viewBox="0 0 24 24" fill="#4285F4" className={iconClass}>
        <path d="M14.727 6.727H14V0H4.91c-.905 0-1.637.732-1.637 1.636v20.728c0 .904.732 1.636 1.636 1.636h14.182c.904 0 1.636-.732 1.636-1.636V6.727h-6zM6.545 6.545h4.909v1.637H6.545zm10.91 14.727H6.544v-1.636h10.91zm0-3.272H6.544v-1.637h10.91zm0-3.273H6.544V13.09h10.91zm0-3.272H6.544v-1.637h10.91zM14.727 0l6 6.727h-6z" />
      </svg>
    ),
  },
  {
    hostnames: ['spotify.com'],
    icon: (
      <svg viewBox="0 0 24 24" fill="#1DB954" className={iconClass}>
        <path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z" />
      </svg>
    ),
  },
];

function getIconForUrl(url: string): React.ReactNode | null {
  try {
    const parsed = new URL(url);
    const hostname = parsed.hostname.replace(/^www\./, '');
    const match = platforms.find((p) =>
      p.hostnames.some(
        (h) =>
          (hostname === h || hostname.endsWith('.' + h)) &&
          (!p.pathPrefix || parsed.pathname.startsWith(p.pathPrefix)),
      ),
    );
    return match?.icon ?? <Globe className={`${iconClass} text-primary`} />;
  } catch {
    return null;
  }
}

export function UrlIcon({ url }: { url?: string | null }) {
  if (!url) return null;
  return getIconForUrl(url);
}
